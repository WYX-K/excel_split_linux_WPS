# Excel 智能拆分工具 (WPS JS版)

这是一个专为 WPS Office (Linux/Windows) 设计的 **JavaScript 宏** 工具，旨在解决复杂的 Excel 表格拆分需求。它可以根据指定的列内容（如机构名称、部门、人员等），将一个包含多个工作表的庞大工作簿，自动批量拆分成多个独立的文件。

## 🎯 核心功能

本项目包含四个核心模块，建议按顺序配合使用：

### 1. 模块1：读取源工作簿
- **功能**：初始化拆分任务。
- **操作**：运行后会弹窗让您选择需要拆分的 Excel 源文件 (`.xlsx`, `.xls` 等)。
- **效果**：自动读取源文件中的所有工作表名称，并填充到参数设置区，供您选择哪些表需要拆分，哪些需要保留或删除。

### 2. 模块2：选择存放目录
- **功能**：设置输出路径。
- **操作**：运行后弹窗选择一个文件夹。
- **效果**：所有拆分后的新文件将自动保存到该目录下，会自动创建一个带时间戳的子文件夹，避免覆盖旧文件。

### 3. 模块3：提取拆分标识
- **功能**：智能分析数据。
- **操作**：根据您在参数表中指定的“关键列”，自动去重提取所有拆分关键字（例如提取所有不同的“分行名称”）。
- **效果**：生成拆分清单，您可以在此基础上二次编辑（如修改生成的文件名）。

### 4. 模块4：拆分源工作簿
- **功能**：执行核心拆分逻辑。
- **操作**：一键启动批量处理。
- **效果**：
    - 读取源文件。
    - 根据拆分标识，循环过滤数据。
    - 删除不相关的数据行。
    - 将结果保存为独立文件。
    - 支持为生成的 Excel 文件设置打开密码。

## 🚀 使用指南

1.  **准备环境**：确保您的电脑安装了支持 JavaScript 宏 (JSA) 的 WPS Office 个人版或企业版。
2.  **打开工具**：打开包含本代码的主 Excel 工作簿（通常包含“拆表参数”和“拆分标识”两个 Sheet）。
3.  **配置参数**：
    - 运行 **模块1**，加载源文件信息。
    - 在“拆表参数”表中，设置每个 Sheet 的处理方式（拆、删、留）以及标题行、表尾行数。
4.  **设置路径**：运行 **模块2**，指定结果保存位置。
5.  **生成清单**：运行 **模块3**，自动生成拆分任务列表。
6.  **开始拆分**：运行 **模块4**，等待进度条完成。

## ⚙️ 参数表说明

- **Sheet名**：源文件中的工作表名称。
- **处理方式**：
    - `拆`：对该表进行筛选拆分。
    - `留`：原样复制该表到新文件（不筛选）。
    - `删`：在新文件中删除该表。
- **关键列**：用于筛选拆分的列号（如 A, B, C...）。
- **标题行数**：表头所占行数（这些行会保留在所有新文件中）。
- **表尾行数**：表尾合计或签章所占行数。

## ⚠️ 注意事项

- 拆分过程中请勿操作鼠标或键盘，以免打断脚本运行。
- 如果源数据量巨大（如几十万行），拆分可能需要几分钟时间，请耐心等待。
- 建议定期备份您的源数据文件。

---
*Generated by Antigravity*
